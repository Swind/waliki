{% extends "page.html" %}

{% block title %}
    History of {{ page.title }}"
{% endblock title %}

{% block content %}
 <div id="diff">
 </div>
{% endblock %}

{% block extra_scripts -%}
    <!-- Taken from http://neil.fraser.name/news/2006/03/19/ //-->
    <script src="/static/diff_match_patch.js"></script>
{% endblock extra_scripts -%}
{% block postscripts -%}
{% if page.new_content %}

function launch() {
  var dmp = new diff_match_patch();
  var new_content = {{ page.new_content|tojson|safe }};
  var old_content = {{ page.old_content|tojson|safe }};
  var d = dmp.diff_main(old_content, new_content);
  dmp.diff_cleanupSemantic(d);
  var ds = dmp.diff_prettyHtml(d);
  $('#footer').append(ds);;
}
launch();
{% endif %}
{% endblock postscripts -%}
